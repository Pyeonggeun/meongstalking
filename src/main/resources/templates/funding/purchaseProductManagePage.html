<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>회원님께서 구매하신 펀딩상품 정보와 활동관리</title>

<script>

    function count(text,length){
        var limit = length;
        var str = text.value.length;
        if(str>limit){
            text.value = text.value.substring(0,limit);
            text.focus();
        }
        document.getElementById("reCount").innerHTML = text.value.length + " / " + limit;
    }


</script>    


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>



<body>
    <div class="container img-fluid">
        <div class="row">
            <div class="col">
    <!--컨테이너 로우 콜 세팅 여기까지-->

    <!-- 회원이 구매한 제품의 간략한 정보와 결제정보 제품 관련 활동 가능해야.... 새소식은 그냥 열람 가능해야 응원과 리뷰 > 그냥 해당 응원페이지로 이동)는 작성할 수 있어야 -->
    <!-- 오더 pk를 가지고 가서 결제 정보와 상품 정보 가져와야 하고 그걸 통해서 리뷰랑도 연결해놓아야 상품 pk로 새소식 가져올 수 있어야 하고 응원글도 달 수 있어야 한다. -->
                
                <div class="row py-2"><div class="col"><a href="./fundingUserMyPage"><i class="bi bi-arrow-left-square" style="color: black;"></i></a></div><div class="col text-end"><a href="./listPage" class="me-3"><i class="bi bi-shop" style="color: black;"></i></a><a href="../commons/mainPage"><i class="bi bi-house" style="color: black;"></i></a></div></div>
                <div class="row mt-4 mb-2"><div class="col" style="font-size: 1em;">나의 펀딩 현황</div></div>

                <div class="row my-2">
                    
                    <div class="row mb-2"><div class="col fw-bold" style="font-size:1.05em;" th:text="${manage.product.product_name}"></div></div>
                    <div class="row"><div class="col ps-3" style="font-size:0.85em;  color: gray;">주문번호</div> <div class="col pe-3 text-end" style="font-size:1em;"><span th:text="${manage.order.order_pk}"></span></div></div>
                    <div class="row"><div class="col-5 ps-3" style="font-size:0.85em;  color: gray;">펀딩 참여 날짜</div> <div class="col pe-3 text-end" style="font-size:1em;"><span th:text="${manage.order.order_date}"></span></div></div>
                    <div class="row"><div class="col ps-3" style="font-size:0.85em;  color: gray;">해당 펀딩 종료일</div><div class="col pe-3 text-end" style="font-size:1em;"><span th:text="${manage.product.finish_date}"></span></div></div>
                    <div class="row"><div class="col ps-3" style="font-size:0.85em;  color: gray;">결제상태</div> <div class="col pe-3 text-end" style="font-size:1em;">결제완료</span></div></div>
                </div>



                <div class="row">
                    <div class="col">내 주문 내역
                        <div class="row"><div class="col ps-3" style="font-size:0.85em; color: gray;">주문 수량</div><div class="col pe-3 text-end"><span th:text="${manage.order.quantity}"></span>개</div></div>
                        <div class="row"><div class="col ps-3" style="font-size:0.85em; color: gray;">제품 개당 가격</div><div class="col pe-3 text-end"><span th:text="${manage.product.price}"></span>원</div></div>
                        <div class="row"><div class="col"></div></div>
                    </div>
                </div>

                <div clas="row">
                    <div class="col py-2 my-2">
                        <div class="row py-2"><div class="col fw-bold" style="font-size:1.05em">내 결제 내역</div></div>
                        <div class="row"><div class="col ps-4" style="font-size:0.9em; color:gray;">펀딩상품 금액</div> <div class="col pe-4 text-end" style="font-size:1em;">0원</div></div>
                        <div class="row"><div class="col ps-4" style="font-size:0.9em; color:gray;">쿠폰 할인 금액</div> <div class="col pe-4 text-end" style="font-size:1em;">0원</div></div>
                        <div class="row"><div class="col ps-4" style="font-size:0.9em; color:gray;">포인트 할인 금액</div> <div class="col pe-4 text-end" style="font-size:1em;">0원</div></div>
                        <div class="row"><div class="col ps-4" style="font-size:0.9em; color:gray;">배송비</div> <div class="col pe-4 text-end" style="font-size:1em;">0원</div></div>
                        <div class="row py-2 mb-2"><div class="col ps-4 fw-bold" style="font-size:1.05em;">총 결제 금액</div> <div class="col pe-4 fw-bold text-end" style="font-size:1.15em;"><span th:text="${manage.order.quantity * manage.product.price}"></span>원</div></div>
                    </div>
                </div>

                <div class="row mt-2 mb-4">
                    <div class="row py-2"><div class="col fw-bold" style="font-size:1.05em">배송 정보</div></div>
                    <div class="row"><div class="col pe-3 text-end" style="font-size:1em;"><span th:text="${session.sessionUser.name}"></span></div></div>
                    <div class="row"><div class="col pe-3 text-end" style="font-size:1em;">서울특별시 관악구 난곡로</div></div>
                    <div class="row"><div class="col pe-3 text-end" style="font-size:1em;"><span th:text="${session.sessionUser.phone}"></span></div></div>
                </div>

                <div class="row mb-2"><div class="col mx-2"><a class="btn  rounded border border-black text-center fw-bold"  th:href="@{./newsReadPage(id =${manage.product.product_pk})}" style="background-color: white; width:100%;"> 해당 제품 새소식 페이지로 이동하기<span class="text-end"><i class="bi bi-arrow-right"></i></span></a></div></div>

                <div class="row mb-2"><div class="col mx-2"><a class="btn rounded border border-black text-center fw-bold"  th:href="@{./cheeringPage(id =${manage.product.product_pk})}" style="background-color: white; width:100%;"> 해당 제품 응원페이지로 이동하기 <span class="text-end"><i class="bi bi-arrow-right"></i></span></a></div></div>
                
                    <div th:if="${orderCount != 1}" class="row border border-start-0 border-end-0 py-2 my-3">
                        <div class="col">
                            <form action="./insertReviewProcess" method="post" enctype="multipart/form-data">   
                                <input type="hidden" name="order_pk" th:value="${manage.order.order_pk}">
                                <input type="hidden" name="product_pk" th:value="${manage.product.product_pk}">
                                <div class="row py-1"><div class="col"> 리뷰 남기기</div><div class="col text-end"><input type="submit" value="리뷰 올리기"  class="border border-black rounded" style="background-color: white;"></div></div>
                                <div class="row"><div class="col">
                                    <div class="row"><div class="col"><textarea onkeyup="count(this,500)" class="form-control" name="content"></textarea></div></div>
                                    <div class="row mb-1"><div class="col"><div style="text-align: right; font-size: 0.75em;"><span id="reCount">0 / 500</span></div></div></div>
                                </div></div>    
                                <div class="row"><div class="col"><input name="reviewImage" type="file" accept="image/*" multiple></div></div>
                                
                            </form>
                        </div>
                    </div>
                <div th:unless="${orderCount != 1}" class="row"><div class="col">이미 리뷰를 작성하셨습니다</div></div>        


                <div class="row"><div class="col"></div></div>
                <div class="row"><div class="col">돌아가기 / 해당 제품 판매 페이지 방문</div></div>







    <!--컨테이너 로우 콜 끝-->
            </div>
        </div>
    </div>
    



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>

</html>
