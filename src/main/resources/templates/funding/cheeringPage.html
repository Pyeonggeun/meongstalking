<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>펀딩상품 응원페이지</title>

    <script>

        function imageBoxClickHandler() {
                        const imageInput = document.getElementById("cheeringImage");
                        imageInput.click();
                    }

        function formSubmit(){
            const insertCheering = document.getElementById("insertCheering");

            const inputContent = document.getElementById("inputContent");
            const inputContentRegex = /^.{10,}$/;
            if(!inputContentRegex.test(inputContent.value)){
                alert("응원글 본문은 10자 이상 작성해 주셔야 등록이 됩니다.");
                inputContent.focus();
                return;
            }
            insertCheering.submit();
        }
    
    
        </script>
    
        <style>
            .box-dashed {
                border-width: 0.15em;
                border-style: dashed;
                width: 99%;    
                color: gray;    
            }

            .offcanvas {
                min-height : 36.5em;
            }

            #writebutton{
                position: fixed;
                bottom: 3em;
                left: 32%;
                
            }
    
        </style>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>


    <div class="row"><div class="col"></div></div>
<body>

<!--새로 짜는 응원글 페이지 -->
    <div class="container img-fluid">
        <div class="row">
            <div class="col">
                
                

                <div class="row" >
                    <div class="col">
                        <div class="row py-2"><div class="col"><a href="./fundingUserMyPage"><i class="bi bi-arrow-left-square" style="color: black;"></i></a></div><div class="col text-end"><a href="./listPage" class="me-3"><i class="bi bi-shop" style="color: black;"></i></a><a href="../commons/mainPage"><i class="bi bi-house" style="color: black;"></i></a></div></div>
                        
                        <button id="writebutton" class="btn text-white border border-3 border-white" style="font-size: 0.9em; background-color:black;" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasBottom" aria-controls="offcanvasBottom">응원글 작성<i class="bi bi-vector-pen"></i></button>

                            <div class="offcanvas offcanvas-bottom" tabindex="-1" id="offcanvasBottom" aria-labelledby="offcanvasBottomLabel">
                                <div class="offcanvas-header">
                                    <h6 class="offcanvas-title fw-bold" id="offcanvasBottomLabel" style="font-size: 1em;">응원글 남기기</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                                </div>

                                <div class="offcanvas-body">
                                    <div class="row mx-1 mb-2">
                                        <div class="col rounded pt-1 pb-3 mb-1" style="background-color: pink; ">
                                            <div class="row py-2"><div class="col fw-bold" style="font-size: 0.85em;"><span><i class="bi bi-exclamation-circle text-danger"></i></span> 주의사항</div></div>
                                            <div class="row"><div class="col" style="font-size: 0.8em;">최근 메이커 또는 제3 자에 대한 허위사실 유포, 비방 목적의 글들로 인해 당사자간 법적분쟁이 매우 빈번하게 발생하고 있습니다. 타 회원들이나 상품에 대한 허위사실을 유포하거나 악의적 성향의 글을 작성하는 경우 명예훼손, 모욕 등으로 법적 책임을 부담하게 될 수 있다는 점을 유의 바랍니다. </div></div>
                                        </div>
                                    </div>

                                    <form id="insertCheering" action="./insertCheering" method="post" enctype="multipart/form-data">
                                        <input type="hidden" name="product_pk" th:value="${product_pk}">
                                        
                                            <div class="row text-center"><div class="col"><textarea id="inputContent" name="content" class="form-control" style="width: 100%; height: 5em;" placeholder="최소 10자 이상 작성 부탁드립니다"></textarea></div></div>
                
                                            <div class="row mt-3 px-0"><div class="col"><span class="fw-bold" style="font-size: 1em;">+ 새소식 이미지 설정</div></div>
                                            <div class="imagePlusBox pt-1 px-0" onclick=imageBoxClickHandler()>
                                                <div class="box-dashed rounded px-1 py-3 text-center">
                                                    <div class="row"><div class="col"> <i class="bi bi-card-image" style="font-size: 2.5em; color: gray;"></i> </div></div> 
                                                    <div class="row"><div class="col"> <span style="font-size: 0.85em; color: gray;">같이 게시될 이미지를 선택해 주세요</span> </div></div> 
                                                </div>
                                                <input id="cheeringImage" name="cheeringImage" class="d-none" type="file" oninput="previewImage()"  accept="image/*" multiple>
                                            </div>
                                            
                                                <div class="row my-3"><div class="col d-grid"><input type="button"  onclick="formSubmit()" value="응원글 등록하기" class="btn rounded border-black py-1" style="background-color: white;"></div></div>         
                                    </form>

                                </div>
                            </div>

                    </div>
                </div>


                <div class="row py-2 mb-2"><div class="col py-1 mx-1 border-bottom" style="font-size: 1.1em;">응원글 <span th:text="${countByPk}" class="px-2 py-1" style="font-size: 1.25em;"></span></div></div>

                <th:block th:each="cheering : ${cheering}">
                    <div class="row mb-2">
                        <div class="col">

                            <div class="row">
                                <div class="col"><span th:text="${cheering.user.userid}" style="font-size: 0.9em;"></span><br><span th:text="${cheering.cheering.created_at}" style="font-size: 0.8em; color: gray;"></span></div>
                                <div class="col"><i class="bi bi-three-dots-vertical"></i></div>
                            </div>

                            <div class="row"><div class="col"><img class="img-fluid" th:src="@{'/uploadFiles/'+${cheering.cheering.cheering_image}}"></div></div>
                            <div class="row"><div class="col" th:text="${cheering.cheering.content}"></div></div>
                            
                        </div>
                    </div>
                </th:block>
















            </div>
        </div>
    </div>




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>

</html>
