<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <script src="https://kit.fontawesome.com/fdd6196f61.js" crossorigin="anonymous"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
        <link rel="stylesheet" th:href="@{/public/css/commons/naviBar.css}" />
        <script src="/public/js/commons/lockLikeMobile.js"></script>
        <script src="/public/js/commons/naviBar.js"></script>
        <script>
             let user_pk = null;
             function getUserDto(){
                const url = "/mstar/getUserDto"
                fetch(url)
                .then(response => response.json())
                .then((response) =>{
                    user_pk = response.data.user_pk;
                    getProfileInfoDto(user_pk);
                });
            }

            let profileInfoDto = null;
            function getProfileInfoDto(user_pk){
                const url = "./myProfileInfoDto?user_pk="+user_pk;
                fetch(url)
                .then(response => response.json())
                .then((response) =>{
                    profileInfoDto = response.data;
                    const profile_info_pk = profileInfoDto.profile_info_pk;
                    const myCommentProfileImg = document.querySelector("#myCommentProfileImg");
                    myCommentProfileImg.src = profileInfoDto.profile_photo;
                    const myStoryListProfileImg = document.querySelector("#myStoryListProfileImg");
                    myStoryListProfileImg.src= profileInfoDto.profile_photo;
                    const my_story_profile_img = document.querySelector("#my_story_profile_img")
                    my_story_profile_img.src =  profileInfoDto.profile_photo;
                    //count가지고 와서 있으면 보여주고 없으면 스토리 등록페이지로;;;;;
                    myStoryCount(profile_info_pk);

                   
                   
                   // goDirectPage.setAttribute("onclick" , "location.href='./directListPage?profile_info_pk="+profile_info_pk+"'");

                    loadArticleList(profile_info_pk);
                    loadStoryProfileList(profile_info_pk)  
                    
                });
            }
            function myStoryCount(profile_info_pk){
                const url ="/mstar/myStoryCount"
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profile_info_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const myStoryListProfileImg = document.querySelector("#myStoryListProfileImg");
                    if(response.data != 0){
                        myStoryListProfileImg.setAttribute("onclick","showMyStoryModal("+profile_info_pk+")");
                    }else{
                        myStoryListProfileImg.setAttribute("onclick","location.href='/mstar/uploadStoryPage?user_pk=+"+user_pk+"'");
                    }
                    
                });
            }

            let storyProfileInPkList = [];
            let currentUser = 0 ;
            function loadStoryProfileList(profile_info_pk){
                storyProfileInPkList =[];
                const url = "./loadStoryList";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profile_info_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const storyListBox = document.querySelector("#storyListBox");
                    let setCount=0;
                    for(e of response.data){
                        const storyProfileListWrapper = document.querySelector("#storyProfileListTemplet .storyProfileListWrapper").cloneNode(true);
                        
                        const storyListProfileImg = storyProfileListWrapper.querySelector(".storyListProfileImg");
                        storyListProfileImg.src = e.profileInfoDto.profile_photo;
                        storyListProfileImg.setAttribute("onclick","showStoryModal("+e.profileInfoDto.profile_info_pk+",this)")
                        storyListProfileImg.setAttribute("id",setCount);
                        setCount += 1;

                        const userId = storyProfileListWrapper.querySelector(".userId");
                        userId.innerText = e.userDto.userid;

                        storyListBox.appendChild(storyProfileListWrapper);
                        storyProfileInPkList.push(e.profileInfoDto.profile_info_pk);
                    }
                });
                
            }

            let storyList = [];
            let currentPage = 0 ;
            function getPeopleStoryList(profile_info_pk){
                currentPage=0;
                storyList=[];
                
                const myProfile_info_pk = profileInfoDto.profile_info_pk;
                const url = "./userStoryList";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profile_info_pk+"&myProfile_info_pk="+myProfile_info_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const barBox = document.querySelector("#barBox");
                    barBox.innerHTML = '';
                    
                    let startPageActive =0;
                    for(e of response.data.storyList){
                        const div = document.createElement("div");
                        div.classList.add("bar");
                        div.setAttribute("id","bar"+e.storyDto.story_pk);
                        
                        barBox.appendChild(div);
                        // 조건을 읽은지 확인하고 3개중 2개읽었으면 3개다 액티브 상태로 마지막사진부터 보여줌
                        if(e.viewStatus == 1){
                            currentPage += 1;
                            div.classList.add("active");
                        }else if(e.viewStatus ==0 && startPageActive == 0){
                            startPageActive +=1;
                            div.classList.add("active");
                        }

                        if(currentPage == response.data.storyList.length){
                            currentPage--;
                        }
                       
                        storyList.push(e.storyDto.story_pk);
                        console.log(e.storyDto.story_pk);
                    }
                    const storyUserid = document.querySelector("#storyUserid");
                    storyUserid.innerText = response.data.userDto.userid;

                    const storyProfileImg = document.querySelector("#storyProfileImg");
                    storyProfileImg.src = response.data.profileInfoDto.profile_photo;

                    const sendDirectButton = document.querySelector("#sendDirectButton");
                    sendDirectButton.setAttribute("onclick", "insertDirect("+profile_info_pk+")");
                    //클릭시 바뀌어야함.
                    
                    loadStory(storyList[currentPage]);
                    
                    
                });
                
            }



            function loadStory(story_pk){
                const url = "./loadUserStory";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "story_pk="+story_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const story_created_at = document.querySelector("#story_created_at");
                    const currentDate = new Date();
                        if (response.data.created_at[0]+"."+response.data.created_at[1]+"."+response.data.created_at[2] == 
        	    			currentDate.getFullYear() +"."+ (currentDate.getMonth()+1) + "."+ currentDate.getDate()){
        	    			if((currentDate.getHours() - response.data.created_at[3]) == 0){
        	    				if((currentDate.getMinutes() - response.data.created_at[4]) < 10){
        	    					story_created_at.innerText = "방금";
        	    				}else{
        	    					story_created_at.innerText = (currentDate.getMinutes() - response.data.created_at[4])+ "분전";
        	    				}
        	    			
        	    			}else{
        	    				story_created_at.innerText = (currentDate.getHours() - response.data.created_at[3])+ "시간전";
        	    			}
        	    		}else{
        	    			story_created_at.innerText = response.data.created_at[0]+"."+response.data.created_at[1]+"."+response.data.created_at[2];
        	    		}

                    const story_img = document.querySelector("#story_img");
                    story_img.style.backgroundImage = "url("+response.data.story_photo+")";
                    //텍스트 + color
                    const story_text = document.querySelector("#story_textAndColor");
                    story_text.innerText = response.data.story_text;
                    story_text.style.color = response.data.text_color;
                    story_text.style.backgroundColor = response.data.background_color;
                    /// x y 위치정보
                    const storyTextBox =  document.querySelector("#storyTextBox");
                    storyTextBox.setAttribute("style", "top:"+response.data.y_coordinates+"%;left:"+response.data.x_coordinates+"%;");
                    if(profileInfoDto.profile_info_pk != storyProfileInPkList[currentUser]){
                        insertViewStory(story_pk);
                    }
                    

                });
            }
            function insertViewStory(story_pk){
                const url = "./insertViewStory";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "story_pk="+story_pk+"&profile_info_pk="+profileInfoDto.profile_info_pk
            	});
            }
            function removeTouchImgEventListener() {
                const story_img = document.querySelector("#story_img");
                story_img.removeEventListener('click', touchImg());
            }


            function touchImg(event) {
                    console.log(event)
        
                    const touchX = event.clientX; // 터치 이벤트의 X 좌표
                    // 이미지의 가로 중앙 좌표
                    const imageCenterX = story_img.getBoundingClientRect().left + story_img.offsetWidth / 2;

                    if (touchX < imageCenterX) {
                        if(currentPage == 0){
                            if(currentUser == 0){
                                closeStoryModal();
                            }else{
                                getPeopleStoryList(storyProfileInPkList[currentUser-1]);
                                currentUser -=1;
                            }
                        }else{
                            loadStory(storyList[currentPage-1]);
                            currentPage -=1;
                            const bar = document.querySelector("#bar"+storyList[currentPage+1]);
                            bar.classList.remove("active");
                        }
                        
                    } else {
                        // 이미지의 오른쪽 절반을 터치했을 때의 처리
                        if(storyList.length == currentPage+1){
                            if(storyProfileInPkList.length == currentUser+1){
                                closeStoryModal();
                            }else{
                                getPeopleStoryList(storyProfileInPkList[currentUser+1]);
                                currentUser +=1;

                            }
                        }else{
                            loadStory(storyList[currentPage+1]);
                            currentPage +=1;
                            const bar = document.querySelector("#bar"+storyList[currentPage]);
                            bar.classList.add("active");
                        }
                        
                    }
                }


            function showStoryModal(profile_info_pk, target){
                currentUser = parseInt(target.getAttribute("id"));
                
                getPeopleStoryList(profile_info_pk);

                const story_img = document.querySelector("#story_img");
                
                story_img.addEventListener('click', touchImg);
                
                const storyModal = bootstrap.Modal.getOrCreateInstance("#storyModal");
                storyModal.show();
            }

            function closeStoryModal(){
                const storyModal = bootstrap.Modal.getOrCreateInstance("#storyModal");
                storyModal.hide();
                
                const story_img = document.querySelector("#story_img");
                story_img.removeEventListener("click", touchImg);    
            } 
            
            function loadArticleList(profile_info_pk){
                const url = "./loadArticeleList";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profile_info_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const articleListBox = document.querySelector("#articleListBox");
                    
                    for(e of response.data){

                        const articleListWrapper = document.querySelector("#articleListTemplete .articleListWrapper").cloneNode(true);
                        
                        
                        const articleUserId = articleListWrapper.querySelector(".articleUserId");
                        articleUserId.innerText = e.userDto.userid;
                        
                        
                        const articleScrapButton = articleListWrapper.querySelector(".articleScrapButton");
                        const scrapIcon = articleListWrapper.querySelector(".scrapIcon");

                        if(e.scrapStatus == 0){
                            articleScrapButton.setAttribute("onclick", "insertArticleScrap("+e.articleDto.article_pk+" , this)");
                            scrapIcon.classList.add("fa-regular");

                        }else{
                            articleScrapButton.setAttribute("onclick", "deleteArticleScrap("+e.articleDto.article_pk+", this)");
                            scrapIcon.classList.add("fa-solid","text-primary");
                        }
                        const commnetListButton = articleListWrapper.querySelector(".commnetListButton");
                        commnetListButton.setAttribute("onclick", "openCommentListBox("+e.articleDto.article_pk+", this)");

                        const directButton = articleListWrapper.querySelector(".directButton");
                        if(profile_info_pk == e.profileInfoDto.profile_info_pk){
                            directButton.classList.add("d-none");
                        }else{
                            directButton.setAttribute("onclick", "location.href='./directPage?profile_info_pk="+profile_info_pk+"&another_info_pk="+e.profileInfoDto.profile_info_pk+"'");
                        }
                        

                        const profile_photo = articleListWrapper.querySelector(".profile_photo");
                        profile_photo.setAttribute("src", e.profileInfoDto.profile_photo);

                        const goProfile = articleListWrapper.querySelector(".goProfile");
                        if(profile_info_pk != e.profileInfoDto.profile_info_pk){
                            goProfile.setAttribute("onclick", "location.href='./anotherProfilePage?profile_info_pk="+profile_info_pk+"&another_info_pk="+e.profileInfoDto.profile_info_pk+"'");
                            articleUserId.setAttribute("onclick", "location.href='./anotherProfilePage?profile_info_pk="+profile_info_pk+"&another_info_pk="+e.profileInfoDto.profile_info_pk+"'");
                        }else{
                            goProfile.setAttribute("onclick", "location.href='./profilePage?user_pk="+user_pk+"'");
                            articleUserId.setAttribute("onclick", "location.href='./profilePage?user_pk="+user_pk+"'");
                        }
                        
                        const likeCountAndUserId = articleListWrapper.querySelector(".likeCountAndUserId");
                        if(e.likeList[0] != null){
                            var count = 0;
                            for(l of e.likeList){
                                count += 1;
                                const likeProfile = articleListWrapper.querySelector(".likeProfile"+count);
                                likeProfile.src = l.profileInfoDto.profile_photo;
                                likeProfile.classList.remove("d-none");
                            }    
                            likeCountAndUserId.style.paddingLeft = (count-1) * 0.7 + "em";
                            const span1 = document.createElement("span");
                            span1.classList.add("fw-bold");
                            span1.innerText = e.likeList[0].userDto.userid;

                            const span2 = document.createElement("span");
                            span2.classList.add("another")
                            const span3 = document.createElement("span");
                            span3.classList.add("likeCount");
                            if(e.likeCount == 1){
                                span2.innerText = " 님";
                                
                            }else{
                                span2.innerText = " 님 외 ";
                                span3.classList.add("fw-bold");
                                span3.innerText = (e.likeCount-1)+"명"; 
                            }
                            const span4 = document.createElement("span");
                            span4.innerText = "이 좋아합니다.";

                            likeCountAndUserId.appendChild(span1);
                            likeCountAndUserId.appendChild(span2);
                            likeCountAndUserId.appendChild(span3);
                            likeCountAndUserId.appendChild(span4);

                        }else{
                            if(e.likeCount != 0){
                                const span3 = document.createElement("span");
                                span3.classList.add("likeCount");
                                span3.classList.add("fw-bold");
                                span3.innerText = e.likeCount+"명"
                                const span4 = document.createElement("span");
                                span4.innerText = "이 좋아합니다.";
                                likeCountAndUserId.appendChild(span3);
                                likeCountAndUserId.appendChild(span4);
                            }
                        }
                        
                        

                        const articleImgBox = articleListWrapper.querySelector(".articleImgBox");

                        const carouselWrapper = document.querySelector("#carouselTemplete .carouselWrapper").cloneNode(true);
                        
                        carouselWrapper.setAttribute("id","carouselId"+e.articleDto.article_pk);
                        carouselWrapper.setAttribute("data-bs-target" ,"carouselId"+e.articleDto.article_pk);
                        
                        const articleImg = carouselWrapper.querySelector(".articleImg");

                        const backButton = carouselWrapper.querySelector(".backButton");
                        backButton.setAttribute("data-bs-target","#carouselId"+e.articleDto.article_pk);
                        
                        const nextButton = carouselWrapper.querySelector(".nextButton");
                        nextButton.setAttribute("data-bs-target","#carouselId"+e.articleDto.article_pk);
                        var count =1 ;
                        //const articleSizeBox = articleListWrapper.querySelector(".articleSizeBox");
                        // <div id="articleSizeTemplete" class="d-none">
                        //     <div class="col-auto px-1 articleSizeWrapper">
                        //         <i class="fa-solid fa-circle ps-0 point"></i>
                        //     </div>
                        // </div>
                        
                        
                        
                        const indicatorBox = carouselWrapper.querySelector(".indicatorBox");
                        for(p of e.photoAndTagList){
                            const articleImgWrapper =  document.querySelector("#articleImgTemplete .articleImgWrapper").cloneNode(true);
                            
                            const indicatorButton = document.querySelector("#carouselIndicatorTemplete .indicatorButton").cloneNode(true);
                           

                            const img = articleImgWrapper.querySelector(".img");
                            
                            
                            const photoCount = articleImgWrapper.querySelector(".photoCount");
                            if(!(e.photoAndTagList.length <= 1)){
                                photoCount.classList.remove("d-none");
                                photoCount.innerText = count+"/"+e.photoAndTagList.length;
                                indicatorButton.setAttribute("data-bs-target","#carouselId"+e.articleDto.article_pk);
                                indicatorButton.setAttribute("data-bs-slide-to" , count-1);
                                indicatorBox.appendChild(indicatorButton);

                            }
                            if(count ==1){
                                articleImgWrapper.classList.add("active");
                                indicatorButton.classList.add("active");
                            }
                            count +=1;
                            if(p.userTagList.length !=0){
                                const checkTag = articleImgWrapper.querySelector(".checkTag");
                                checkTag.classList.remove("d-none");
                            }
                          
                            
                            
                            
                            img.src = p.artPhotoDto.photo_path;
                            for(i of p.userTagList){
                                const tagWrapper = document.querySelector("#tagTemplete .tagWrapper").cloneNode(true);
                                const tag = tagWrapper.querySelector(".tag");
                                tag.innerText = i.userid
                                tagWrapper.setAttribute("style", "left:" +i.articleTagDto.x_coordinates+ "%; top:"+i.articleTagDto.y_coordinates + "%;");
                                articleImgWrapper.appendChild(tagWrapper);
                            }
                            if(p.userTagList.length !=0){
                                articleImgWrapper.setAttribute("onclick", "showTagUser(this)");
                            }
                            

                            articleImg.appendChild(articleImgWrapper);
                            
                        }
                        
                        articleImgBox.appendChild(carouselWrapper);

                        
                        var carousel = new bootstrap.Carousel(carouselWrapper);
                        carousel.prev();

                        const contentUserId = articleListWrapper.querySelector(".contentUserId");
                        // const useridSpan = document.createElement("span");
                        // useridSpan.classList.add("fw-bold","pe-2");
                        // useridSpan.innerText = e.userDto.userid;
                        const contentSpan = document.createElement("span");
                        
                        contentSpan.innerText = e.userDto.userid +" "+ e.articleDto.content;
                        
                        

                        const showMoreContent = document.createElement("span");

                        //contentUserId.appendChild(useridSpan);
                        contentUserId.appendChild(contentSpan);
                        console.log(e.articleDto.content.length)
                        if(e.articleDto.content.length > 80){
                            contentSpan.classList.add("content_ellipsis" ,"content");
                            const moreContent =  document.createElement("span");
                            moreContent.setAttribute("onclick", "showMoreContent(this)");
                            moreContent.innerText = "더보기"
                            moreContent.classList.add("text-primary");
                            moreContent.style.opacity = "0.7";
                            contentUserId.appendChild(moreContent);
                        }
            
            
            
                        const emotion = articleListWrapper.querySelector(".emotion");
                        if(e.articleDto.emotion == "POSITIVE"){
                            emotion.innerText =  "긍정";
                            emotion.classList.add("text-primary");
                        }else if(e.articleDto.emotion == "NEGATIVE"){
                            emotion.innerText =  "부정";
                            emotion.classList.add("text-danger");
                        }else if(e.articleDto.emotion == "MIXED"){
                            emotion.innerText =  "혼합";
                            emotion.classList.add("text-warning");
                        }else if(e.articleDto.emotion == "NEUTRAL"){
                            emotion.innerText =  "보통";
                            
                            
                        }
                        

                        const followStatus = articleListWrapper.querySelector(".followStatus");
                        if(e.followStatus == 0 && profile_info_pk != e.profileInfoDto.profile_info_pk){
                            followStatus.innerText = "팔로우";
                            followStatus.style.backgroundColor = "rgb(228,226,226 )";
                            followStatus.setAttribute("onclick","followingUser("+e.profileInfoDto.profile_info_pk+", this)");
                        }
                        const myProfileImg = articleListWrapper.querySelector("#myProfileImg");
                        myProfileImg.src = profileInfoDto.profile_photo;

                        const articleLike = articleListWrapper.querySelector(".articleLike");
                        if(e.articleLikeStatus == 1){
                            articleLike.src = "/public/image/mstar/like.png";
                            articleLike.setAttribute("onclick","deleteArticleLike("+e.articleDto.article_pk+", this)");
                        }else{
                            articleLike.src = "/public/image/mstar/unLike.png";
                            articleLike.setAttribute("onclick","insertArticleLike("+e.articleDto.article_pk+", this)");
                        }
                        

                        const articleCreatedAt = articleListWrapper.querySelector(".articleCreatedAt");
                        
                        const currentDate = new Date();
                        if (e.articleDto.created_at[0]+"."+e.articleDto.created_at[1]+"."+e.articleDto.created_at[2] == 
        	    			currentDate.getFullYear() +"."+ (currentDate.getMonth()+1) + "."+ currentDate.getDate()){
        	    			if((currentDate.getHours() - e.articleDto.created_at[3]) == 0){
        	    				if((currentDate.getMinutes() - e.articleDto.created_at[4]) < 10){
        	    					articleCreatedAt.innerText = "방금";
        	    				}else{
        	    					articleCreatedAt.innerText = (currentDate.getMinutes() - e.articleDto.created_at[4])+ "분전";
        	    				}
        	    			
        	    			}else{
        	    				articleCreatedAt.innerText = (currentDate.getHours() - e.articleDto.created_at[3])+ "시간전";
        	    			}
        	    		}else{
        	    			articleCreatedAt.innerText = e.articleDto.created_at[0]+"."+e.articleDto.created_at[1]+"."+e.articleDto.created_at[2];
        	    		}
                        
                        const writeCommentBox = articleListWrapper.querySelector(".writeCommentBox");
                        writeCommentBox.setAttribute("onclick", "openCommentWriteBox("+e.articleDto.article_pk+",this)");
                        
                    
                        
                        const commentCount  = articleListWrapper.querySelector(".commentCount");
                        if(e.articleCommentCount != 0){
                            commentCount.innerText = "댓글 "+e.articleCommentCount+"개 모두 보기";
                        }else{
                            commentCount.innerText = "댓글 달기";
                        }
                        commentCount.setAttribute("onclick", "openCommentListBox("+e.articleDto.article_pk+", this)");
                        

                        articleListBox.appendChild(articleListWrapper);
                    }

                });
            }
            function showMoreContent(target){
                const  contentUserId = target.closest(".contentUserId");
                const content =  contentUserId.querySelector(".content");
                content.classList.remove("content_ellipsis");
                target.remove();
            }
           

            function showTagUser(target){
                
                const articleImgWrapper = target.closest(".articleImgWrapper");
                const tagWrapper = articleImgWrapper.querySelectorAll(".tagWrapper");
                for(let i = 0; i < tagWrapper.length; i++ ){
                    tagWrapper[i].classList.remove("d-none")
                    tagWrapper[i].classList.add("animate");
                }
                const checkTag = articleImgWrapper.querySelector(".checkTag");
                checkTag.classList.add("d-none");
                articleImgWrapper.setAttribute("onclick","hideTagUser(this)");
            }
            function hideTagUser(target){
                
                const articleImgWrapper = target.closest(".articleImgWrapper");
                const tagWrapper = articleImgWrapper.querySelectorAll(".tagWrapper");
                for(let i = 0; i < tagWrapper.length; i++ ){
                    tagWrapper[i].classList.add("d-none")
                }
                const checkTag = articleImgWrapper.querySelector(".checkTag");
                checkTag.classList.remove("d-none");
                articleImgWrapper.setAttribute("onclick","showTagUser(this)");
            }

            function followingUser(another_info_pk, target){
                const url = "/mstar/followingAnotherUser";

                fetch(url, {
                    method: "post",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: "following_user_pk="+profileInfoDto.profile_info_pk+"&follow_user_pk="+another_info_pk
                });
                target.remove();
            }
            
            function insertArticleComment(article_pk){
                const comment = document.querySelector("#commentText").value;
                const profile_info_pk = profileInfoDto.profile_info_pk;
               
               
                const url = "./insertMyComment";

                fetch(url, {
                    method: "post",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: "profile_info_pk="+profile_info_pk+"&comment="+comment+"&article_pk="+article_pk
                })
                .then(response => response.json())
                .then((response) =>{
                    commentText.value = "";
                    loadArticeleCommentList(article_pk);
                    console.log(articleListWrapperTarget);
                    if(articleListWrapperTarget != null){
                        const writeMyCommentBox = articleListWrapperTarget.querySelector(".writeMyCommentBox");

                        const writeMyCommentWrapper = document.querySelector("#writeMyCommentTemplete .writeMyCommentWrapper").cloneNode(true);

                        const content = writeMyCommentWrapper.querySelector(".content");
                        const spans = document.createElement("spans");
                        spans.innerText = response.data.comment;
                        content.appendChild(spans);

                        const likebutton = writeMyCommentWrapper.querySelector(".likebutton");
                        likebutton.setAttribute("onclick", "insertLikeOutside("+response.data.comment_pk+", this)");

                        writeMyCommentBox.appendChild(writeMyCommentWrapper);

                        articleListWrapperTarget = null; 
                    }
                    
                });
            }
            function reloadCommentCount(article_pk, target){
                const url ="./reloadCommentCount";
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "article_pk="+article_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const articleListWrapper = target.closest("#articleListWrapper");
                    const commentCount = articleListWrapper.querySelector(".commentCount");
                    commentCount.innerText = "댓글 "+response.data.commentCount+"개 모두 보기";



                    
                });
            }

            function loadArticeleCommentList(article_pk, target){
                const url = "./loadArticeleCommentList";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "article_pk="+article_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                   
                    const articleCommentListBox = document.querySelector("#articleCommentListBox");
                    articleCommentListBox.innerHTML = "";
                   for(e of response.data){
                        const commentListWrapper = document.querySelector("#commentListTemplete .commentListWrapper").cloneNode(true);

                        const comment_pk_value = commentListWrapper.querySelector(".comment_pk_value");
                        comment_pk_value.setAttribute("value", e.commentDto.comment_pk);

                        const commentProfilePhoto = commentListWrapper.querySelector(".commentProfilePhoto");
                        commentProfilePhoto.src = e.profileInfoDto.profile_photo;

                        const commentUserId = commentListWrapper.querySelector(".commentUserId");
                        commentUserId.innerText = e.userDto.userid;

                        const checkWriter= commentListWrapper.querySelector(".checkWriter");

                        
                            
                        if(e.checkWriterLikeComment == 1){
                            checkWriter.innerText = "\u00B7 ❤️작성자가 이 댓글을 좋아합니다.";
                        }else if(e.writerProfilePk == e.commentDto.profile_info_pk){
                            checkWriter.innerText = "\u00B7 작성자";
                        }

                        const created_at = commentListWrapper.querySelector(".created_at");
                        const currentDate = new Date();

                        const createdDate = new Date(e.commentDto.created_at[0], e.commentDto.created_at[1] - 1, e.commentDto.created_at[2], e.commentDto.created_at[3], e.commentDto.created_at[4], e.commentDto.created_at[5]);
                        const timeDifference = currentDate - createdDate;
                        const weeksDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24 * 7));

                        if (createdDate.toDateString() === currentDate.toDateString()) {
                            if (currentDate.getHours() - createdDate.getHours() === 0) {
                                if (currentDate.getMinutes() - createdDate.getMinutes() < 10) {
                                    created_at.innerText = "방금";
                                } else {
                                    created_at.innerText = (currentDate.getMinutes() - createdDate.getMinutes()) + "분전";
                                }
                            } else {
                                created_at.innerText = (currentDate.getHours() - createdDate.getHours()) + "시간전";
                            }
                        } else {
                            const hoursDifference = Math.floor(timeDifference / (1000 * 60 * 60));
                            const daysDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

                            if (hoursDifference < 24) {
                                created_at.innerText = hoursDifference + "시간전";
                            } else if (daysDifference > 0) {
                                created_at.innerText = daysDifference + "일전";
                            } else {
                                created_at.innerText = weeksDifference + "주전";
                            }
                        }
                        const commentLike = commentListWrapper.querySelector(".commentLike");

                        if(e.commentLike == 0){
                            commentLike.classList.add("fa-regular","text-secondary");
                            commentLike.setAttribute("onclick", "insertLikeStatus("+e.commentDto.comment_pk+", this)");
                        }else{
                            commentLike.classList.add("fa-solid","text-danger");
                            commentLike.setAttribute("onclick", "deleteLikeStatus("+e.commentDto.comment_pk+", this)");
                        }

                        const commentLikeCount = commentListWrapper.querySelector(".commentLikeCount");
                        if(e.commentLikeCount !=0){
                            commentLikeCount.innerText = e.commentLikeCount;
                        }
                        


                        const comment = commentListWrapper.querySelector(".comment");
                        comment.innerText = e.commentDto.comment;

                        const writeTcomment = commentListWrapper.querySelector(".writeTcomment");
                        
                        writeTcomment.innerText = "답글 달기";
                        writeTcomment.setAttribute("onclick","writeTcomment("+e.commentDto.comment_pk+",'"+e.userDto.userid+"',this)");
                        
                            
                        const tcommentCount = commentListWrapper.querySelector(".tcommentCount");
                        
                        if(e.tCommentCount != 0){
                            tcommentCount.innerText = "----  답글 "+e.tCommentCount+"개 더보기";
                            tcommentCount.setAttribute("onclick","showTcommentList("+e.commentDto.comment_pk+",'"+e.userDto.userid+"', this)");    
                        }

                        articleCommentListBox.appendChild(commentListWrapper);
                   }

                });
            }
            function insertLikeStatus(comment_pk, target){
                const url = "./likeComment"
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&comment_pk="+comment_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    target.classList.remove("fa-regular","text-secondary");
                    target.classList.add("fa-solid", "text-danger");
                    target.setAttribute("onclick", "deleteLikeStatus("+comment_pk+", this)");

                    const commentListWrapper = target.closest(".commentListWrapper");

                    const commentLikeCount = commentListWrapper.querySelector(".commentLikeCount");
                    commentLikeCount.innerText = response.data.commentLikeCount;
                    
                        
                    

                    if(response.data.profile_info_pk == response.data.writerProfilePk){
                        const checkWriter = commentListWrapper.querySelector(".checkWriter");
                        checkWriter.innerText = "\u00B7 ❤️작성자가 이 댓글을 좋아합니다.";
                    }
                   
                        
                    
                });
                
                

            }
            function insertLikeOutside(comment_pk, target){
                const url = "./likeComment"
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&comment_pk="+comment_pk
            	});
                    target.classList.remove("fa-regular","text-secondary");
                    target.classList.add("fa-solid", "text-danger");
                    target.setAttribute("onclick", "deleteLikeOutside("+comment_pk+", this)");
            }

            function deleteLikeStatus(comment_pk, target){

                const url = "./deleteComment";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&comment_pk="+comment_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    target.classList.remove("fa-solid", "text-danger");
                    target.classList.add("fa-regular","text-secondary");
                    target.setAttribute("onclick", "insertLikeStatus("+comment_pk+", this)");

                    const commentListWrapper = target.closest(".commentListWrapper");

                    const commentLikeCount = commentListWrapper.querySelector(".commentLikeCount");
                    if(response.data.commentLikeCount == 0){
                        commentLikeCount.innerText = "";
                    }else{
                        commentLikeCount.innerText = response.data.commentLikeCount;
                        
                    }

                    if(response.data.profile_info_pk == response.data.writerProfilePk){
                        const checkWriter = commentListWrapper.querySelector(".checkWriter");
                        checkWriter.innerText = "";
                    }
                    
                });

            }
            
            function deleteLikeOutside(comment_pk, target){

                const url = "./deleteComment";

                fetch(url, {
                    method: "post",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&comment_pk="+comment_pk
                })
                target.classList.remove("fa-solid", "text-danger");
                target.classList.add("fa-regular","text-secondary");
                target.setAttribute("onclick", "insertLikeOutside("+comment_pk+", this)");

            }
            
            let articleListWrapperTarget = null;
            function openCommentWriteBox(article_pk, target) {
                articleListWrapperTarget = target.closest(".articleListWrapper");
                console.log(articleListWrapperTarget);
                const commentListBox = document.querySelector("#commentListBox");
                commentListBox.classList.add("d-none");

                var commentWriteBox = new bootstrap.Offcanvas(document.getElementById('commentWriteBox'));
                commentWriteBox.show();
                const insertCommentButton = document.querySelector("#insertCommentButton");
                insertCommentButton.setAttribute("data-bs-dismiss","offcanvas");
                

                const commentText = document.querySelector("#commentText");
                commentText.value="";
                setTimeout(function () {
                    commentText.focus();
                }, 400);
                const insertButtonColor = document.querySelector("#insertButtonColor");
                commentText.addEventListener("input", function() {
                    // 입력된 글자의 유무에 따라 버튼 활성화/비활성화 처리
                
                    if(commentText.value.trim() === ""){
                        insertButtonColor.style.color = "rgb(190, 190, 245)";
                        insertCommentButton.removeAttribute("onclick");
                        insertCommentButton.setAttribute("disabled","disabled");
                    }else{
                        insertButtonColor.style.color = "rgb(250, 250, 250)";
                        insertCommentButton.setAttribute("onclick", "insertArticleComment("+article_pk+")");
                        insertCommentButton.removeAttribute("disabled")
                    }
                     
                });
                
            }
           

            function loadTcommentList(comment_pk, target){
                const url = "./loadTcommentList";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "comment_pk="+comment_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    var commentListWrapper = null;
                    
                    if(TcommentTarget != null){
                        commentListWrapper = TcommentTarget.closest(".commentListWrapper");
                        console.log(commentListWrapper);
                    }else{
                        commentListWrapper = target.closest(".commentListWrapper");    
                        console.log(commentListWrapper);
                    }
                    const myTcommentBox = commentListWrapper.querySelector(".myTcommentBox");
                    console.log(myTcommentBox);
                    myTcommentBox.innerHTML = "";
                    
                    const tCommentListBox = commentListWrapper.querySelector(".tCommentListBox");
                    tCommentListBox.innerHTML ="";

                    for(e of response.data){
                        const tCommentListWrapper = document.querySelector("#tCommentListTemplete .tCommentListWrapper").cloneNode(true);

                        

                        const profilePhoto = tCommentListWrapper.querySelector(".profilePhoto");
                        profilePhoto.src = e.profileInfoDto.profile_photo;

                        const userId = tCommentListWrapper.querySelector(".userId");
                        userId.innerText = e.userDto.userid;

                        const created_at = tCommentListWrapper.querySelector(".created_at");
                        
                        const createdDate = new Date(e.tCommentDto.created_at[0], e.tCommentDto.created_at[1] - 1, e.tCommentDto.created_at[2], e.tCommentDto.created_at[3], e.tCommentDto.created_at[4], e.tCommentDto.created_at[5]);
                        const currentDate = new Date();
                        const timeDifference = currentDate - createdDate;
                        const weeksDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24 * 7));

                        if (createdDate.toDateString() === currentDate.toDateString()) {
                            if (currentDate.getHours() - createdDate.getHours() === 0) {
                                if (currentDate.getMinutes() - createdDate.getMinutes() < 10) {
                                    created_at.innerText = "방금";
                                } else {
                                    created_at.innerText = (currentDate.getMinutes() - createdDate.getMinutes()) + "분전";
                                }
                            } else {
                                created_at.innerText = (currentDate.getHours() - createdDate.getHours()) + "시간전";
                            }
                        } else {
                            const hoursDifference = Math.floor(timeDifference / (1000 * 60 * 60));
                            const daysDifference = Math.floor(timeDifference / (1000 * 60 * 60 * 24));

                            if (hoursDifference < 24) {
                                created_at.innerText = hoursDifference + "시간전";
                            } else if (daysDifference > 0) {
                                created_at.innerText = daysDifference + "일전";
                            } else {
                                created_at.innerText = weeksDifference + "주전";
                            }
                        }

                        const t_comment = tCommentListWrapper.querySelector(".t_comment");
                        t_comment.innerText = e.tCommentDto.t_comment;

                        tCommentListBox.appendChild(tCommentListWrapper);

                    }
                    const row = document.createElement("div");
                    row.classList.add("row");

                    const col = document.createElement("div");
                    col.classList.add("col","text-secondary");
                    col.style.fontSize = "0.9em";
                    col.innerText = "---- 답글 숨기기";
                    col.setAttribute("onclick", "closeTcommentList("+comment_pk+", this)");

                    row.appendChild(col);

                    tCommentListBox.appendChild(row);
                    
                    TcommentTarget = null;
                });

            }
            function insertTcomment(comment_pk ,target){
                const t_comment = document.querySelector("#commentText").value;
                const profile_info_pk = profileInfoDto.profile_info_pk;
                
               
                const url = "./insertMyTcomment";
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profile_info_pk+"&comment_pk="+comment_pk+"&t_comment="+t_comment
            	});

                // 카운트값 가지고와서 변화시켜줘야해...    
                const commentText = document.querySelector("#commentText");
                removeWriteTcomment();
                commentText.value = "";
                
                const commentListWrapper = TcommentTarget.closest(".commentListWrapper");
                const myTcommentBox =  commentListWrapper.querySelector(".myTcommentBox");

                const myTcommentWrapper = document.querySelector("#myTcommentTemplete .myTcommentWrapper").cloneNode(true);
                const myProfilePhoto = myTcommentWrapper.querySelector(".myProfilePhoto");
                myProfilePhoto.src = profileInfoDto.profile_photo;

                const comment = myTcommentWrapper.querySelector(".t_comment");
                comment.innerText = t_comment;

                myTcommentBox.appendChild(myTcommentWrapper);

                setTimeout(function () {
                    loadTcommentList(comment_pk, target);
                }, 400);
                


            }
            var commentSwitch = null;
            var TcommentTarget = null;
            function writeTcomment(comment_pk , userid, target){
                commentSwitch =true;
                const commentText = document.querySelector("#commentText");
                commentText.value="";
                TcommentTarget= target;
               const insertCommentButton = document.querySelector("#insertCommentButton");
               //insertCommentButton.setAttribute("onclick", "insertTcomment("+comment_pk+")");
               

               const tCommentStatusBox = document.querySelector("#tCommentStatusBox");
               tCommentStatusBox.classList.remove("d-none");
               
               const commentUser_id = document.querySelector("#commentUser_id");
            
               commentUser_id.innerText = userid+"님 에게 답글작성 중";

            }
            function removeWriteTcomment(){
                commentSwitch = null;
                const commentText = document.querySelector("#commentText");
                commentText.value="";

                const tCommentStatusBox = document.querySelector("#tCommentStatusBox");
                tCommentStatusBox.classList.add("d-none");

                const articlePK = document.querySelector("#articlePK").value;

                const insertCommentButton = document.querySelector("#insertCommentButton");
                insertCommentButton.removeAttribute("onclick");

            }

            function showTcommentList(comment_pk, userid, target){
                loadTcommentList(comment_pk, target);   

                const commentListWrapper = target.closest(".commentListWrapper");
                
                const tcommentCount = commentListWrapper.querySelector(".tcommentCount");
                tcommentCount.classList.add("d-none");

            }
            function closeTcommentList(comment_pk, target){
                removeWriteTcomment();
                
                const tCommentListBox = target.closest(".tCommentListBox");
                tCommentListBox.innerHTML ="";
                const commentListWrapper =  tCommentListBox.closest(".commentListWrapper");
                
                const tcommentCount = commentListWrapper.querySelector(".tcommentCount");
                tcommentCount.classList.remove("d-none");
                
            }

            function openCommentListBox(article_pk) {
                console.log(TcommentTarget);
                
                loadArticeleCommentList(article_pk);
                const articlePK = document.querySelector("#articlePK");
                articlePK.value = article_pk;

                const commentListBox = document.querySelector("#commentListBox");
                commentListBox.classList.remove("d-none");

                var commentWriteBox = new bootstrap.Offcanvas(document.getElementById('commentWriteBox'));
                commentWriteBox.show();
                const insertCommentButton = document.querySelector("#insertCommentButton");
                insertCommentButton.removeAttribute("data-bs-dismiss");
                

                const commentText = document.querySelector("#commentText");
                commentText.value="";
                
                

                const insertButtonColor = document.querySelector("#insertButtonColor");
                commentText.addEventListener("input", function() {
                    // 입력된 글자의 유무에 따라 버튼 활성화/비활성화 처리
                    if(commentSwitch == null){
                        if(commentText.value.trim() === ""){
                            insertButtonColor.style.color = "rgb(190, 190, 245)";
                            insertCommentButton.removeAttribute("onclick");
                            insertCommentButton.setAttribute("disabled","disabled");
                        }else{
                            insertButtonColor.style.color = "rgb(250, 250, 250)";
                            insertCommentButton.setAttribute("onclick", "insertArticleComment("+article_pk+")");
                            insertCommentButton.removeAttribute("disabled")
                        }
                    }else{
                        if(commentText.value.trim() === ""){
                            insertButtonColor.style.color = "rgb(190, 190, 245)";
                            insertCommentButton.removeAttribute("onclick");
                            insertCommentButton.setAttribute("disabled","disabled");
                        }else{
                            const commentListWrapper = TcommentTarget.closest(".commentListWrapper");
                            const comment_pk = commentListWrapper.querySelector(".comment_pk_value").value;
                            
                        
                            insertButtonColor.style.color = "rgb(250, 250, 250)";
                            insertCommentButton.setAttribute("onclick", "insertTcomment("+comment_pk+")");
                            insertCommentButton.removeAttribute("disabled")
                        }

                    }
                        
                    
                });

            }
            function reloadArticleLikeCount(article_pk, target){
                const url = "/mstar/reloadArticleLikeCount";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "article_pk="+article_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const articleListWrapper = target.closest(".articleListWrapper");
                    const likeCount = articleListWrapper.querySelector(".likeCount");
                    if(likeCount != null){
                        if(response.data != 0){
                            likeCount.innerText = response.data+"명";
                        }else{
                            likeCount.innerText = "";
                        }
                    }else{
                        const likeCountAndUserId = articleListWrapper.querySelector(".likeCountAndUserId");
                        if(response.data != 0){
                            likeCountAndUserId.innerText = response.data+"명이 좋아합니다.";
                        }else{
                            likeCountAndUserId.innerText = "";
                        }
                    }
                    
                   
                    console.log(likeCount)
                    
                });
            }


            ///////////////////새로운마음으로 시작해보자!!!
            function insertArticleLike(article_pk, target){
                const url = "/mstar/insertMyArticleLike";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "article_pk="+article_pk+"&profile_info_pk="+profileInfoDto.profile_info_pk
            	})
                .then((response) =>{
                    const articleListWrapper = target.closest(".articleListWrapper");
                
                    const articleLike = articleListWrapper.querySelector(".articleLike");
                    
                    articleLike.src = "/public/image/mstar/like.png";
                    articleLike.setAttribute("onclick","deleteArticleLike("+article_pk+", this)");
                    
                    reloadArticleLikeCount(article_pk, target)
                });
                
                

            }

            function deleteArticleLike(article_pk, target){
                const url = "./deleteMyArticleLike";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "article_pk="+article_pk+"&profile_info_pk="+profileInfoDto.profile_info_pk
            	})
                .then((response) =>{
                    const articleListWrapper = target.closest(".articleListWrapper");
                    const articleLike = articleListWrapper.querySelector(".articleLike");
                    articleLike.src = "/public/image/mstar/unLike.png";
                    articleLike.setAttribute("onclick","insertArticleLike("+article_pk+", this)");
                    reloadArticleLikeCount(article_pk, target)
                });
                
            }

            function insertArticleScrap(article_pk, target){
                const url = "./articleScrap";
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&article_pk="+article_pk
            	});
                
                const articleListWrapper = target.closest(".articleListWrapper");
                
                const articleScrapButton = articleListWrapper.querySelector(".articleScrapButton");
                articleScrapButton.setAttribute("onclick", "deleteArticleScrap("+e.articleDto.article_pk+" , this)");

                const scrapIcon = articleListWrapper.querySelector(".scrapIcon");
                scrapIcon.classList.remove("fa-regular");
                scrapIcon.classList.add("fa-solid","text-primary");
                        
            }
            
            function deleteArticleScrap(article_pk, target){
                const url = "./removeArticleScrap";
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "profile_info_pk="+profileInfoDto.profile_info_pk+"&article_pk="+article_pk
            	});
                const articleListWrapper = target.closest(".articleListWrapper");
                
                const articleScrapButton = articleListWrapper.querySelector(".articleScrapButton");
                articleScrapButton.setAttribute("onclick", "insertArticleScrap("+e.articleDto.article_pk+" , this)");

                const scrapIcon = articleListWrapper.querySelector(".scrapIcon");
                scrapIcon.classList.remove("fa-solid","text-primary");
                scrapIcon.classList.add("fa-regular");
            }


            /////////////////////////////// 내스토리 보여주기...
            let myStoryList = [];
            let myCurrentPage = 0 ;
            function loadMyStoryList(profile_info_pk){
                myCurrentPage=0;
                
                const url = "./loadMyStoryList";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                     body: "profile_info_pk="+profile_info_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const myBarBox = document.querySelector("#myBarBox");
                    myBarBox.innerHTML = '';
                    
                    console.log(response.data);
                    let startPageActive = 0;
                    for(e of response.data){
                        
                        const div = document.createElement("div");
                        div.classList.add("bar");
                        div.setAttribute("id","myBar"+e.story_pk);
                        if(startPageActive == 0){
                            div.classList.add("active");
                        }
                        startPageActive += 1;
                        myBarBox.appendChild(div);                        
                        myStoryList.push(e.story_pk);
                    }
                    console.log(myStoryList)
                    //클릭시 바뀌어야함.
                    
                    loadMyStory(myStoryList[myCurrentPage]);
                    
                });
            }

            function loadMyStory(story_pk){
                const url = "./loadUserStory";
                
                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "story_pk="+story_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    
                    const my_story_created_at = document.querySelector("#my_story_created_at");
                    const d = response.data.created_at;
                    my_story_created_at.innerText = d[0]+"."+d[1]+"."+d[2]+".";

                    const my_story_img = document.querySelector("#my_story_img");
                    my_story_img.style.backgroundImage = "url("+response.data.story_photo+")";
                    //텍스트 + color
                    const my_story_text = document.querySelector("#my_story_textAndColor");
                    my_story_text.innerText = response.data.story_text;
                    my_story_text.style.color = response.data.text_color;
                    my_story_text.style.backgroundColor = response.data.background_color;
                    /// x y 위치정보
                    const my_storyTextBox =  document.querySelector("#my_storyTextBox");
                    my_storyTextBox.setAttribute("style", "top:"+response.data.y_coordinates+"%;left:"+response.data.x_coordinates+"%;");

                    loadMyStoryViewInfo(story_pk);

                });
            }
            function removeTouchImgEventListener() {
                const my_story_img = document.querySelector("#my_story_img");
                my_story_img.removeEventListener('click', touchMyImg());
            }


            function touchMyImg(event) {
                
                const touchX = event.clientX; // 터치 이벤트의 X 좌표
                // 이미지의 가로 중앙 좌표
                const imageCenterX = my_story_img.getBoundingClientRect().left + my_story_img.offsetWidth / 2;

                if (touchX < imageCenterX) {
                    if(currentPage == 0){
                            closeMyStoryModal();
                    }else{
                        loadMyStory(myStoryList[myCurrentPage-1]);
                        myCurrentPage -=1;
                        const bar = document.querySelector("#myBar"+myStoryList[myCurrentPage+1]);
                        bar.classList.remove("active");
                    }
                    
                } else {
                    // 이미지의 오른쪽 절반을 터치했을 때의 처리
                    if(myStoryList.length == myCurrentPage+1){                            
                            closeMyStoryModal();
                    }else{
                        loadMyStory(myStoryList[myCurrentPage+1]);
                        myCurrentPage +=1;
                        const bar = document.querySelector("#myBar"+myStoryList[myCurrentPage]);
                        bar.classList.add("active");
                    }
                    
                }
            }
            function loadMyStoryViewInfo(story_pk){
                const url = "./loadMyStoryViewInfo";

                fetch(url, {
                     method: "post",
                     headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                      body: "story_pk="+story_pk
            	})
                .then(response => response.json())
                .then((response) =>{
                    const viewCount = document.querySelector("#viewCount");
                    viewCount.innerText = response.data.viewCount;

                    
                    if(response.data.viewList.length != 0){
                        let setCount = 1;
                        for(e of response.data.viewList){
                            if(setCount == 4){
                                return
                            }else{
                                const viewProfile = document.getElementById("viewProfile"+setCount); 
                                viewProfile.src = e.profileInfoDto.profile_photo;
                                viewProfile.classList.remove("d-none");
                                setCount +=1;
                            }
                            
                        }     
                    }
                   
                });
            }
            


            function showMyStoryModal(profile_info_pk){
                loadMyStoryList(profile_info_pk);
                
                const my_story_img = document.querySelector("#my_story_img");
                
                my_story_img.addEventListener('click', touchMyImg);
                
                const myStoryModal = bootstrap.Modal.getOrCreateInstance("#myStoryModal");
                myStoryModal.show();
            }

            function closeMyStoryModal(){
                const myStoryModal = bootstrap.Modal.getOrCreateInstance("#myStoryModal");
                myStoryModal.hide();
                
                const my_story_img = document.querySelector("#my_story_img");
                my_story_img.src ="";
                my_story_img.removeEventListener("click", touchMyImg);    
            } 

            function insertDirect(another_info_pk){
                
                const directChat = document.querySelector("#directChat");
                const chat = directChat.value;

                const url = "./insertDirect";

                fetch(url, {
                    method: "post",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: "send_user_pk="+profileInfoDto.profile_info_pk+"&rcv_user_pk="+another_info_pk+"&chat="+chat
                });
                directChat.value = "";
               
            }
            


            function appendHeart(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "❤️"
                commentText.focus();
            }
            function appendTwoHands(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "🙌"
                commentText.focus();
            }
            function appendSmileSad(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "🤣"
                commentText.focus();
            }
            function appendHeartFace(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "😍"
                commentText.focus();
            }
            function appendSad(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "😢"
                commentText.focus();
            }
            function appendSuprise(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "😮"
                commentText.focus();
            }
            function appendFire(){
                const commentText = document.querySelector("#commentText");
                commentText.value += "🔥"
                commentText.focus();
            }


            window.addEventListener("DOMContentLoaded", () =>{
                getUserDto();
                
            });
        </script>
        <style>
            @font-face {
                font-family: 'omyu_pretty';
                src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2304-01@1.0/omyu_pretty.woff2') format('woff2');
                font-weight: normal;
                font-style: normal;
            }

            body {
                font-family: 'omyu_pretty';
                
            }

            #d-none-scroll::-webkit-scrollbar {
                display: none;
            }

            .offcanvas-backdrop {
                background-color: rgba(0, 0, 0, 0.1); 
            }
            .profileImg {
                position: relative;
                border: 0.1em solid transparent;
                border-radius: 50%;
                background-image: linear-gradient(#fff, #fff), 
                linear-gradient(to right, red 0%,  orange 100%);
                background-origin: border-box;
                background-clip: content-box, border-box;
            }
            .swipe-container {
                overflow-x: scroll;
                white-space: nowrap;
            }

            .swipe-container .col {
                vertical-align: top;
                display: inline-block;
                width: 25%;
            }
            #myBarBox{
                display: flex;
                height: 0.25em;
           }
            #barBox{
                display: flex;
                height: 0.25em;
           }
            .bar {
                width: 92%;
                height: 0.15em; /* 바의 높이 설정 */
                background-color: rgb(89, 86, 86); /* 바의 배경색 설정 */
                margin-right: 0.2em;
            }
            
            .bar.active {
                background-color: rgb(229, 223, 223);
              
            }

            .bar:last-child {
                margin-right: 1em;
            } 
            .bar:first-child {
                margin-left: 1em;
            }
            .form-control::placeholder {
                color: white; /* placeholder 글자 색상을 원하는 색상으로 설정 */
                font-size: 0.9em
            }
            .modal-fullscreen {
                width: 100%;
            }
            .tag {
                position: relative;
                display: inline-block;
                padding: 0.2em 0.4em;
                background-color: #4f5152;
                color: #fff;
                font-size: 0.8em;
                border-radius: 4px;
            }
            .tag::before {
                content: '';
                position: absolute;
                top: 100%; /* 말풍선이 아래로 향하도록 변경 */
                left: 50%;
                margin-left: -0.2em; /* 말풍선 너비의 반으로 설정 */
                border-width: 5px;
                border-style: solid;
                border-color: #4f5152 transparent transparent transparent;
            }
            .sizeUP {
                /* 초기 스타일 설정 (애니메이션이 시작되기 전 스타일) */
                transform: scale(1);
            }

            .sizeUP.animate {
                /* 애니메이션 클래스가 추가되었을 때의 스타일 설정 */
                animation: zoom 0.5s linear;
            }

            @keyframes zoom {
                50% {
                    transform: scale(1.1);
                }
            }
            @keyframes rotate {
                from {
                    transform: rotate(0deg);
                }
                to {
                    transform: rotate(360deg);
                }
            }
            .rotating-icon {
                
                animation: rotate 8s linear infinite;
            }
            @keyframes blink {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
           
            }

            .blinking-icon {
                animation: blink 1s linear infinite;
            }
            @keyframes moveLeftRight {
                0% {
                    transform: translateX(0);
                }
                50% {
                    transform: translateX(0.2em); /* 이동할 거리를 조절할 수 있습니다. */
                    opacity: 0.8;
                }
            }
            
            .movingleftright-icon {
                animation: moveLeftRight 2s ease-in-out infinite;
            }
            @keyframes moveupdown {
                0% {
                    transform: translateY(0);
                }
                50% {
                    transform: translateY(0.2em); /* 이동할 거리를 조절할 수 있습니다. */
                    opacity: 0.8;
                }
            }

            .movingupdown-icon {
                animation: moveupdown 2s ease-in-out infinite;
            }
            .content_ellipsis {
                text-overflow: ellipsis;/* 말줄임 css */
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 2;
                overflow: hidden;
            }
            .carousel-indicators{
                color: blue;
            }
        </style>
    </head>

    <body>
        <div class="container-fluid">
            <div th:insert="~{commons/naviBar}"></div>
            <div class="row">
                <div class="col">
                    <div class="row mt-1 fs-4">
                        <div class="col">
                            Mstargram
                        </div>
                        <div class="col text-end">
                            <i th:onclick="|location.href='@{/mstar/writeArticlePage(user_pk=${session.sessionUser.user_pk})}'|" class="fa-regular fa-square-plus"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div id="d-none-scroll" class="row mt-3 overflow-x-auto">
                <div class="col">
                    <div id="storyListBox" class="row">
                        <div class="col-auto px-3">
                            <div class="row">
                                <div class="col-auto profileImg px-0 py-0">
                                    <img id="myStoryListProfileImg" class="img-fluid rounded-circle border border-1" src="" alt="" style="aspect-ratio: 1/1; height: 4em;">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col px-0 text-center " style="font-size: 0.8em;">
                                    내 스토리+
                                </div>
                            </div>
                        </div>
                        <!--반복문 구간-->
                    </div>
                </div>
            </div>
            <div class="row">
                <div id ="articleListBox" class="col">
                
                </div>
            </div>
        </div>
        <!-- 스토리 반복문 -->
        <div id="storyProfileListTemplet" class="d-none">
            <div class="col-auto px-3 storyProfileListWrapper">
                <div class="row">
                    <div class="col-auto profileImg px-0 py-0">
                        <img class="img-fluid rounded-circle border border-1 storyListProfileImg" src="" alt="" style="aspect-ratio: 1/1; height: 4em;">
                    </div>
                </div>
                <div class="row">
                    <div class="col px-0 text-center userId " style="font-size: 0.8em;">
                        
                    </div>
                </div>
            </div>
        </div>
        <!--게시물 반복문-->
        <div id="articleListTemplete" class="d-none">
            <div class="row articleListWrapper">
                <div class="col">
                    <div class="row">
                        <div class="col py-3">
                            <div class="row " style="position: relative;">
                                <div class="col-2 goProfile">
                                    <img class="profile_photo img-fluid rounded-circle float-start" src="" style="aspect-ratio: 1/1;">
                                </div>
                                <div class="col my-auto ps-0" style="font-size: 0.95rem;">
                                    <div class="row">
                                        <div class="col-auto pe-0 articleUserId">
                                            
                                        </div>
                                    </div>      
                                </div>  
                                <div class="col-2 text-center my-auto py-0 px-0 rounded followStatus" style="font-size: 0.9em">
                                    
                                </div>
                                <div class="col-2 px-0 text-center my-auto">
                                    <i class="fa-solid fa-ellipsis text-body-tertiary"></i>
                                </div>
                                <div class="col-7 text-secondary text-truncate d-block" style="position: absolute; top: 60%; left: 14%; font-size: small;">
                                    서울시 23-3 여의도 벚꽃길, 뽀삐와 삐뽀와
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col articleImgBox px-0">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pt-2">
                            <div class="row fs-5">
                                <div class="col-auto ">
                                    <img class="img-fluid pt-0 mb-1 articleLike" alt="" style="height: 1em;">
                                </div>
                                <div class="col-auto px-0 text-start commnetListButton">
                                    <i class="fa-regular fa-comment-dots"></i>
                                </div>
                                <div class="col text-start directButton">
                                    <i class="fa-regular fa-paper-plane"></i>
                                </div>
                                <div class="col align-self-center" style="font-size: 0.3em;">
                                    <div class="row justify-content-center articleSizeBox">
                                        
                                    </div>
                                </div>
                                <div class="col-2"></div>
                                <div class="col-auto text-end articleScrapButton">
                                    <i class="fa-regular fa-bookmark scrapIcon"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row pt-0">
                        <div class="col-auto ps-2 pe-1 likeProfileListBox" style="position: relative;">
                            <img class="img-fluid rounded-circle float-start border border-white border-2 likeProfile1 d-none"  style="aspect-ratio: 1/1; height: 1.5em;">
                            <img class="img-fluid rounded-circle float-start border border-white border-2 likeProfile2 d-none"  style="aspect-ratio: 1/1; height: 1.5em; position: absolute; left: 60%; z-index: 2">
                            <img class="img-fluid rounded-circle float-start border border-white border-2 likeProfile3 d-none"  style="aspect-ratio: 1/1; height: 1.5em; position: absolute; left: 120%; z-index: 3">
                        </div>
                        <div class="col likeCountAndUserId" style="padding-left: 0em; font-size: 0.9em;">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pb-0">
                            <div class="row">
                                <div class="col pe-0 contentUserId fw-bold">
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-auto text-secondary align-self-center" style="font-size: 0.9em;">
                            AI 감정 분석 결과:
                        </div>
                        <div class="col ps-0 text-start emotion">
                                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col pt-1 pb-0">
                            <div class="row">
                                <div class="col px-4">
                                    <div class="row row-cols-auto">
                                        <div class="col ps-0 pe-1">
                                            <span style="color: #95B372;">#</span><span style="color: #687795;">멍스타</span>
                                        </div>
                                        <div class="col ps-0 pe-1">
                                            <span style="color: #95B372;">#</span><span style="color: #687795;">멍스토킹</span>
                                        </div>
                                        <div class="col ps-0 pe-1">
                                            <span style="color: #95B372;">#</span><span style="color: #687795;">강아지</span>
                                        </div>
                                        <div class="col ps-0 pe-1">
                                            <span style="color: #95B372;">#</span><span style="color: #687795;">중앙</span>
                                        </div>
                                        <div class="col ps-0 pe-1">
                                            <span style="color: #95B372;">#</span><span style="color: #687795;">해쉬태그</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row pt-1">
                        <div class="col text-secondary commentCount">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col writeMyCommentBox">
                            
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-auto">
                            <img id="myProfileImg" class="img-fluid rounded-circle float-start border border-white border-2 "  style="aspect-ratio: 1/1; height: 35px; position: relative;">
                        </div>
                        <div class="col mt-1 text-secondary writeCommentBox">
                            댓글 달기...
                        </div>
                    </div>
                    <div class="row">
                        <div class="col px-4 py-1">
                            <div class="row">
                                <div class="col text-body-tertiary ps-0 articleCreatedAt" style="font-size: 0.8rem;">
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        
            
            

        <div class="offcanvas offcanvas-bottom" tabindex="-1" id="commentWriteBox" aria-labelledby="offcanvasBottomLabel" style="height: auto; background-color: transparent; border: none; padding-left: 0.7rem; padding-right: 0.7rem;"> 
            <div id="commentListBox" class="row d-none">
                <div class="col bg-white" style="border-top-left-radius: 2.3em; border-top-right-radius: 2.3em; border-top: 0.1em solid rgb(211, 211, 215) ;">
                    <div class="row py-2 ">
                        <div class="col-5"></div>
                        <div class="col rounded-pill border-4" style="background-color: rgb(194, 195, 195); height: 0.2em;"></div>
                        <div class="col-5"></div>
                    </div>
                    <div class="row border-bottom mt-2">
                        <div class="col-2"></div>
                        <div class="col fs-4 fw-bold text-center">
                            댓글
                        </div>
                        <div class="col-2 fs-4">
                            <i class="fa-regular fa-paper-plane"></i>
                        </div>
                    </div>
                    <div class="row overflow-y-auto">
                        <div id="articleCommentListBox" class="col" style="height: 20em;">
                           
                        </div>
                    </div>
                </div>
            </div>
            <div class="row bg-white">
                <div class="col">
                    <div id="tCommentStatusBox" class="row ps-3 py-2 d-none" style="background-color: #dddfe3;">
                        <input id="articlePK" type="hidden">
                        <div id="commentUser_id" class="col text-secondary " style="font-size: 0.9em;">
                            
                        </div>
                        <div class="col-2 pe-4 text-end">
                            <i onclick="removeWriteTcomment()" class="fa-solid fa-xmark" style="font-size: 0.8em;"></i>
                        </div>
                    </div>
                    <div class="row fs-3 py-2 border-top border-2">
                        <div onclick="appendHeart()" class="col ms-3" style="user-select: none;">
                            ❤️
                        </div>
                        <div onclick="appendTwoHands()" class="col" style="user-select: none;">
                            🙌
                        </div>
                        <div onclick="appendFire()" class="col" style="user-select: none;">
                            🔥
                        </div>
                        <div onclick="appendSad()" class="col" style="user-select: none;">
                            😢
                        </div>
                        <div onclick="appendHeartFace()" class="col" style="user-select: none;">
                            😍
                        </div>
                        <div onclick="appendSuprise()" class="col" style="user-select: none;">
                            😮
                        </div>
                        <div onclick="appendSmileSad()" class="col me-3" style="user-select: none;">
                            🤣
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-auto ms-3">
                            <div class="row">
                                <div class="col">
                                    <img id="myCommentProfileImg" class="img-fluid rounded-circle" alt="" style="aspect-ratio: 1/1; height: 2.7em;">
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="row rounded-pill me-4" style="border: 0.1em solid rgb(215, 216, 220)">
                                <div class="col">
                                    <input id="commentText" class="form-control px-0" type="text" style="box-shadow: none; border: none;" placeholder="Jo_inchune(으)로 댓글 달기..">
                                </div>
                                <div id="insertCommentButton" class="col-auto py-0 text-center py-0 rounded-pill mx-2 my-1" disabled data-bs-dismiss="offcanvas" style="background-color: rgb(81, 120, 235);">
                                    <i id="insertButtonColor" class="fa-solid fa-arrow-up pt-1" style="color: rgb(190, 190, 245);"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="commentListTemplete" class="d-none">
            <div class="row my-1 pb-3 commentListWrapper">
                <input class="comment_pk_value" type="hidden">
                <div class="col-auto ms-3">
                    <div class="row">
                        <div class="col-auto profileImg px-0 py-0 ">
                            <img class="img-fluid rounded-circle border border-2 commentProfilePhoto " alt="" style="height: 2em; aspect-ratio: 1/1;">
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="row">
                        <div class="col-auto ps-1 fw-bold pe-0 commentUserId" style="font-size: 0.8em;">
                            
                        </div>
                        <div class="col-auto ps-1 pe-0 text-secondary created_at" style="font-size: 0.8em; padding-top: 0.1em;">
                            
                        </div>
                        <div class="col-auto px-0 text-secondary checkWriter" style="font-size: 0.8em; padding-top: 0.1em;">
                           
                        </div>
                    </div>
                    <div class="row">
                        <div class="col ps-1 comment" style="font-size: 0.9em;">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-secondary">
                           
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col-auto ps-1 text-secondary writeTcomment" style="font-size: 0.9em;">
                                    
                                </div>
                            </div>
                            <div class="row">
                                <div class="col myTcommentBox">

                                </div>
                            </div>
                            <div class="row">
                                <div class="col ps-1 text-secondary tcommentCount" style="font-size: 0.9em;">

                                </div>
                            </div>
                            <div class="row">
                                <div class="col tCommentListBox">

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-2">
                    <div class="row">
                        <div class="col-auto mt-2">
                            <div class="row">
                                <div class="col">
                                    <i class="fa-heart commentLike"></i>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col text-secondary text-center commentLikeCount" style="font-size: 0.8em;">
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="writeMyCommentTemplete" class="d-none">
            <div class="row align-self-center writeMyCommentWrapper">
                <div class="col-11 text-start content" style="font-size: 0.9em;">
                    <spans class="fw-bold" th:text="${session.sessionUser.userid}"></spans>
                </div>
                <div class="col-1 ps-0 align-self-center" style="font-size: 0.9em;">
                    <i class="fa-heart fa-regular likebutton"></i>
                </div>
            </div>
        </div>

        <div id="tCommentListTemplete" class="d-none">
            <div class="row mt-2 tCommentListWrapper">
                <div class="col-auto">
                    <div class="row">
                        <div class="col-auto profileImg px-0 py-0">
                            <img class="img-fluid rounded-circle border border-2 profilePhoto" alt="" style="aspect-ratio: 1/1; height: 2em;">
                        </div>
                    </div>
                </div>
                <div class="col ps-2" >
                    <div class="row align-self-center">
                        <div class="col-auto pe-0 userId" style="font-size: 0.8em;">
                            
                        </div>
                        <div class="col ps-2 text-secondary created_at" style="font-size: 0.8em;">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col t_comment" style="font-size: 0.8em;">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="myTcommentTemplete" class="d-none">
            <div class="row mt-2 myTcommentWrapper">
                <div class="col-auto">
                    <div class="row">
                        <div class="col-auto profileImg px-0 py-0">
                            <img class="img-fluid rounded-circle border border-2 myProfilePhoto" alt="" style="aspect-ratio: 1/1; height: 2em;">
                        </div>
                    </div>
                </div>
                <div class="col ps-2" >
                    <div class="row align-self-center">
                        <div class="col-auto pe-0" th:text="${session.sessionUser.userid}" style="font-size: 0.8em;">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col t_comment" style="font-size: 0.8em;">
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="articleImgTemplete" class="d-none">
            <div class="carousel-item articleImgWrapper">
                <img class="d-block w-100 img" alt="..." style="height: 21em;">
                <div class="col-auto position-absolute fs-3" style="color: #3f4041; position: absolute; top: 87%; left: 3%; opacity: 0.7">
                    <i id="" class="fa-solid fa-circle-user rounded-circle checkTag d-none" style="background-color: rgb(165, 163, 163);"></i>
                </div>
                <div  class="col-auto position-absolute rounded-pill px-2 photoCount d-none" style="color: #dbd5d5;background-color: #636262; position: absolute; top: 3%; left: 90%; opacity: 0.7;">
                    
                </div>
            </div>
        </div>

        <div id="tagTemplete" class="d-none">
            <div class="col-auto sizeUP tagWrapper position-absolute d-none" style="position: absolute; top: 45%; left: 45%;">
                <div class="tag">jo_in_chun</div>
            </div>
        </div>

        <div id="carouselTemplete" class="d-none">
            <div class="carousel slide carouselWrapper" data-bs-wrap="false" >
                <div class="carousel-indicators indicatorBox">

                </div>
                <div class="carousel-inner articleImg" style="overflow: hidden;">
                    
                </div>
                <button class="carousel-control-prev backButton d-none" type="button"  data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next nextButton d-none" type="button" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>

        <div id="carouselIndicatorTemplete" class="d-none">
            <button type="button" data-bs-target=".carouselWrapper" class="rounded-circle indicatorButton" aria-current="true" style="width: 0.3em; height: 0.3em;"></button>
        </div>

        <div id="storyModal" class="modal" tabindex="-1">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content " style="background-color: black; overflow: hidden;">
                    <div class="modal-body" style="overflow: hidden;">
                        <div class="row">
                            <div class="col">
                                <div id="barBox" class="mt-1 "> 
                                    
                                </div>
                            </div>
                        </div>
                        <div class="row text-light mt-2">
                            <div class="col-auto">
                                <img id="storyProfileImg" class="rounded-circle ms-2"  alt="" style="aspect-ratio: 1/1; height: 2em;">
                            </div>
                            <div id="storyUserid" class="col-auto align-self-center px-0">
                                
                            </div>
                            <div id="story_created_at" class="col-auto text-secondary align-self-center pt-1" style="font-size: 0.9em;">
                                
                            </div>
                            <div class="col text-end text-white fs-5">
                                <i class="fa-solid fa-ellipsis"></i>
                            </div>
                            <div class="col-auto pe-4 text-end text-white fs-4">
                                <i class="fa-solid fa-xmark"></i>
                            </div>
                        </div>
                        <div id="story_img" class="row position-relative px-0 rounded" style="height: 35em; background-size: 100%; background-repeat: no-repeat; background-position: center; background-color: rgb(49, 49, 49); top: 1rem;">   
                            <div class="col px-0">
                                
                            </div>
                            <div id="storyTextBox" class="col-auto px-0 position-absolute" style="cursor: pointer; top: 50%; left: 0%;">
                                <div id="story_textAndColor" class="px-2">
                                    
                                </div>
                            </div>
                        </div>    
                        <div class="row px-2 py-3 mt-3">
                            <div class="col ps-0">
                                <input id="directChat" class="form-control rounded-pill border-white py-1 text-white" type="text" placeholder="메세지를 입력해주세요." style="background-color: transparent;">
                            </div>
                            <div class="col-auto ps-0 text-end me-1 text-white fs-4 align-self-center">
                                <i id="sendDirectButton" class="fa-regular fa-paper-plane"></i>
                            </div>
                        </div>
                    </div>    
                </div>
            </div>
        </div>
       
        <div id="myStoryModal" class="modal" tabindex="-1">
            <div class="modal-dialog modal-fullscreen">
                <div class="modal-content " style="background-color: black; overflow: hidden;">
                    <div class="modal-body" style="overflow: hidden;">
                        <div class="row">
                            <div class="col">
                                <div id="myBarBox" class="mt-1 "> 
                                    
                                </div>
                            </div>
                        </div>
                        <div class="row text-light mt-2">
                            <div class="col-auto">
                                <img id="my_story_profile_img" class="rounded-circle ms-2"  alt="" style="aspect-ratio: 1/1; height: 2em;">
                            </div>
                            <div id="my_story_userid" class="col-auto align-self-center px-0">
                                
                            </div>
                            <div id="my_story_created_at" class="col-auto text-secondary align-self-center pt-1" style="font-size: 0.9em;">
                                
                            </div>
                            <div class="col pe-4 text-end text-white fs-4">
                                <i class="fa-solid fa-xmark" data-bs-dismiss="modal"></i>
                            </div>
                        </div>
                        <div id="my_story_img" class="row position-relative px-0 rounded" style="height: 35em; background-size: 100%; background-repeat: no-repeat; background-position: center; background-color: rgb(49, 49, 49); top: 1rem;">   
                            <div class="col px-0">
                                
                            </div>
                            <div id="my_storyTextBox" class="col-auto px-0 position-absolute" style="cursor: pointer; top: 50%; left: 0%;">
                                <div id="my_story_textAndColor" class="px-2">
                                    
                                </div>
                            </div>
                        </div>    
                        <div class="row px-2 py-3 mt-3">
                            <div onclick="showViewBox()" class="col-auto">
                                <div class="row">
                                    <div class="col align-self-center" style="font-size: 0.8em;">
                                        <i class="fa-solid fa-eye text-white"></i>
                                    </div>
                                </div>
                                <div class="row">
                                    <div id="viewCount" class="col align-self-center text-white text-center" style="font-size: 0.9em;">
                                        
                                    </div>
                                </div>
                            </div>
                            <div onclick="showViewBox()" class="col ps-2 pe-1 likeProfileListBox align-self-center">
                                <img id="viewProfile1" class="img-fluid rounded-circle float-start border border-white border-2 d-none " src=""  style="aspect-ratio: 1/1; height: 2em; position: relative; z-index: 3;">
                                <img id="viewProfile2" class="img-fluid rounded-circle float-start border border-white border-2 d-none" src=""  style="aspect-ratio: 1/1; height: 2em; position: absolute; left: 5em; z-index: 2">
                                <img id="viewProfile3" class="img-fluid rounded-circle float-start border border-white border-2 d-none" src=""  style="aspect-ratio: 1/1; height: 2em; position: absolute; left: 6.5em; z-index: 1">
                            </div>
                        </div>
                    </div>    
                </div>
            </div>
        </div>
        
        <div id="articleSizeTemplete" class="d-none">
            <div class="col-auto px-1 articleSizeWrapper">
                <i class="fa-solid fa-circle ps-0 point text-secondary"></i>
            </div>
        </div>
        
       
        
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    </body>

</html>